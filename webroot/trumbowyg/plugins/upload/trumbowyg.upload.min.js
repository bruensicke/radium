!function(e){function o(){var o=e.ajaxSettings.xhr;e.ajaxSetup({xhr:function(){var e=o(),a=this;return e&&"object"==typeof e.upload&&void 0!==a.progressUpload&&e.upload.addEventListener("progress",function(e){a.progressUpload(e)},!1),e}})}o(),e.extend(!0,e.trumbowyg,{langs:{en:{upload:"Upload",file:"File",uploadError:"Error"},fr:{upload:"Envoi",file:"Fichier",uploadError:"Erreur"}},upload:{serverPath:"./trumbowyg/plugins/upload/trumbowyg.upload.php"},opts:{btnsDef:{upload:{func:function(o,a){var r,t=a.o.prefix;$modal=a.openModalInsert(a.lang.upload,{file:{type:"file",required:!0},alt:{label:"description"}},function(){var o=new FormData;o.append("fileToUpload",r),0==e("."+t+"progress",$modal).length&&e("."+t+"modal-title",$modal).after(e("<div/>",{"class":t+"progress"}).append(e("<div/>",{"class":t+"progress-bar"}))),e.ajax({url:e.trumbowyg.upload.serverPath,type:"POST",data:o,cache:!1,dataType:"json",processData:!1,contentType:!1,progressUpload:function(o){e("."+t+"progress-bar").stop().animate({width:Math.round(100*o.loaded/o.total)+"%"},200)},success:function(o){"uploadSuccess"==o.message?(a.execCommand("insertImage",o.file),setTimeout(function(){a.closeModal()},250)):a.addErrorOnModalField(e("input[type=file]",$modal),a.lang[o.message])},error:function(){a.addErrorOnModalField(e("input[type=file]",$modal),a.lang.uploadError)}})}),e("input[type=file]").on("change",function(e){r=e.target.files[0]})}}}}})}(jQuery);